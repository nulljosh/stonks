<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Polymarket Assistant - Monte Carlo Terminal</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/recharts@2.10.3/umd/Recharts.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html, body, #root { height: 100%; width: 100%; }
        body { font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display", sans-serif; }
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.2); border-radius: 3px; }
    </style>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel">
const { useState, useMemo, useCallback } = React;
const { LineChart, Line, XAxis, YAxis, Tooltip, ResponsiveContainer, Area, ComposedChart, ReferenceLine, BarChart, Bar, Cell } = Recharts;

// Math
const sRand = s => { const x = Math.sin(s + 1) * 10000; return x - Math.floor(x); };
const nRand = s => { const u = Math.max(0.0001, sRand(s)); return Math.sqrt(-2 * Math.log(u)) * Math.cos(2 * Math.PI * sRand(s + 0.5)); };
const nCDF = x => { const s = x < 0 ? -1 : 1, a = Math.abs(x) / 1.414, t = 1 / (1 + 0.3275911 * a); return 0.5 * (1 + s * (1 - ((((1.061405429 * t - 1.453152027) * t + 1.421413741) * t - 0.284496736) * t + 0.254829592) * t * Math.exp(-a * a))); };
const bsP = (S, K, r, v, T) => T <= 0 ? (S > K ? 1 : 0) : nCDF((Math.log(S / K) + (r + 0.5 * v * v) * T) / (v * Math.sqrt(T)) - v * Math.sqrt(T));

// Fibonacci calculator
const calcFibTargets = (spot, low52, high52) => {
  const range = high52 - low52;
  return {
    fib236: spot + range * 0.236,
    fib382: spot + range * 0.382,
    fib500: spot + range * 0.5,
    fib618: spot + range * 0.618,
    fib786: spot + range * 0.786,
    fib100: spot + range * 1.0,
    fib1272: spot + range * 1.272,
    fib1618: spot + range * 1.618,
  };
};

function LiquidGlassTerminal() {
  const [dark, setDark] = useState(true);
  const [asset, setAsset] = useState('silver');
  const [scenario, setScenario] = useState('base');
  const [sel, setSel] = useState(0);
  const [view, setView] = useState('quote');
  const [simSeed, setSimSeed] = useState(42);
  const [showMacro, setShowMacro] = useState(false);

  // Apple Liquid Glass theme
  const t = dark ? {
    bg: '#000000',
    surface: 'rgba(28,28,30,0.8)',
    glass: 'rgba(255,255,255,0.06)',
    glassHover: 'rgba(255,255,255,0.12)',
    border: 'rgba(255,255,255,0.1)',
    text: '#FFFFFF',
    textSecondary: 'rgba(255,255,255,0.6)',
    textTertiary: 'rgba(255,255,255,0.4)',
    accent: '#0A84FF',
    green: '#30D158',
    red: '#FF453A',
    yellow: '#FFD60A',
    orange: '#FF9F0A',
    purple: '#BF5AF2',
    cyan: '#64D2FF',
    pink: '#FF375F',
  } : {
    bg: '#F2F2F7',
    surface: 'rgba(255,255,255,0.8)',
    glass: 'rgba(255,255,255,0.9)',
    glassHover: 'rgba(255,255,255,1)',
    border: 'rgba(0,0,0,0.1)',
    text: '#000000',
    textSecondary: 'rgba(0,0,0,0.6)',
    textTertiary: 'rgba(0,0,0,0.4)',
    accent: '#007AFF',
    green: '#34C759',
    red: '#FF3B30',
    yellow: '#FFCC00',
    orange: '#FF9500',
    purple: '#AF52DE',
    cyan: '#5AC8FA',
    pink: '#FF2D55',
  };

  // Asset data with Fibonacci-derived institutional levels
  const [assets] = useState({
    // PRECIOUS METALS - Real institutional levels from search
    silver: {
      name: 'XAGUSD', full: 'Silver Spot', spot: 78.55, chg: -2.69, chgPct: -3.32,
      vol: 0.42, hi52: 85.85, lo52: 22,
      // Fibonacci/institutional levels from research
      support: [70, 67.50, 66.30], // 38.2% fib, MA confluence
      resistance: [80, 85.85, 100], // Key resistance, ATH, psychological
      targets: [85.85, 100, 150], // Near-term, institutional, stretch
      notes: '$100 is 2026 consensus target. Supply deficit persists.'
    },
    gold: {
      name: 'XAUUSD', full: 'Gold Spot', spot: 4458.95, chg: -35.69, chgPct: -0.79,
      vol: 0.30, hi52: 4550, lo52: 2600,
      support: [4373, 4316, 4164], // Key pivots from research
      resistance: [4509, 4576, 4762], // Fib extensions
      targets: [4576, 5000, 5500], // Fib 127.2%, psychological, stretch
      notes: 'Central banks buying 850t/year. $5000 is 2026 bull target.'
    },
    platinum: {
      name: 'XPTUSD', full: 'Platinum', spot: 2306, chg: 12.4, chgPct: 0.54,
      vol: 0.35, hi52: 2450, lo52: 900,
      support: [2100, 2000, 1850],
      resistance: [2450, 3000, 3500],
      targets: [3000, 4000, 4500],
      notes: 'Supply deficit 7 of 11 years. Catalyst converter demand.'
    },
    palladium: {
      name: 'XPDUSD', full: 'Palladium', spot: 1799, chg: -69.2, chgPct: -3.72,
      vol: 0.38, hi52: 1900, lo52: 850,
      support: [1650, 1500, 1350],
      resistance: [1900, 2200, 2500],
      targets: [2200, 2800, 3500],
      notes: 'Russia supply risk. EV transition headwind.'
    },
    // BASE METALS
    copper: {
      name: 'COPPER', full: 'Copper HG', spot: 5.94, chg: 0.12, chgPct: 2.06,
      vol: 0.28, hi52: 6.10, lo52: 3.80,
      support: [5.50, 5.20, 4.80],
      resistance: [6.10, 6.50, 7.00],
      targets: [6.50, 7.50, 9.00],
      notes: 'Data center/EV demand. Chile strikes. Record highs.'
    },
    nickel: {
      name: 'NICKEL', full: 'Nickel LME', spot: 18472, chg: 97, chgPct: 0.53,
      vol: 0.32, hi52: 19000, lo52: 15000,
      support: [17500, 16500, 15500],
      resistance: [19000, 20000, 22000],
      targets: [20000, 24000, 28000],
      notes: 'Indonesia 34% output cut proposed. EV battery demand.'
    },
    // ENERGY
    oil: {
      name: 'USOIL', full: 'WTI Crude', spot: 73.56, chg: -0.82, chgPct: -1.10,
      vol: 0.35, hi52: 95, lo52: 65,
      support: [70, 67, 65],
      resistance: [78, 85, 95],
      targets: [85, 100, 120],
      notes: 'OPEC+ cuts. Venezuela capture uncertainty.'
    },
    natgas: {
      name: 'NATGAS', full: 'Natural Gas', spot: 3.18, chg: -0.05, chgPct: -1.55,
      vol: 0.55, hi52: 4.20, lo52: 1.80,
      support: [3.00, 2.80, 2.50],
      resistance: [3.50, 4.00, 4.50],
      targets: [4.00, 5.00, 6.50],
      notes: 'AI data center power demand. LNG exports.'
    },
    // US INDICES
    nas100: {
      name: 'NAS100', full: 'NASDAQ 100', spot: 25653.6, chg: 14.0, chgPct: 0.05,
      vol: 0.22, hi52: 26000, lo52: 17000,
      support: [25000, 24000, 23000],
      resistance: [26000, 27500, 30000],
      targets: [27000, 30000, 35000],
      notes: 'AI concentration risk. Mag7 = 40% of index.'
    },
    us500: {
      name: 'US500', full: 'S&P 500', spot: 6924.1, chg: -21.7, chgPct: -0.31,
      vol: 0.18, hi52: 7000, lo52: 4800,
      support: [6800, 6500, 6200],
      resistance: [7000, 7200, 7500],
      targets: [7200, 7800, 8500],
      notes: 'Shiller PE at 38. Concentration highest since 1930s.'
    },
    us30: {
      name: 'US30', full: 'Dow Jones 30', spot: 48996.0, chg: -491.5, chgPct: -0.99,
      vol: 0.16, hi52: 50000, lo52: 37000,
      support: [48000, 46000, 44000],
      resistance: [50000, 52000, 55000],
      targets: [52000, 55000, 60000],
      notes: 'Value rotation potential if AI unwinds.'
    },
    // CRYPTO
    btc: {
      name: 'BTCUSD', full: 'Bitcoin', spot: 101500, chg: 1250, chgPct: 1.25,
      vol: 0.65, hi52: 108000, lo52: 38000,
      support: [95000, 90000, 85000],
      resistance: [108000, 120000, 150000],
      targets: [120000, 150000, 200000],
      notes: 'ETF inflows. Halving supply shock. $200K bull target.'
    },
    eth: {
      name: 'ETHUSD', full: 'Ethereum', spot: 3680, chg: 85, chgPct: 2.36,
      vol: 0.70, hi52: 4100, lo52: 2100,
      support: [3500, 3200, 3000],
      resistance: [4100, 5000, 6000],
      targets: [5000, 7500, 10000],
      notes: 'Staking yield. L2 scaling. DeFi revival potential.'
    },
    // MACRO
    dxy: {
      name: 'DXY', full: 'US Dollar Index', spot: 97.50, chg: -0.45, chgPct: -0.46,
      vol: 0.12, hi52: 110, lo52: 95,
      support: [96.50, 95.00, 92.00],
      resistance: [100.50, 103.00, 106.00],
      targets: [95, 90, 85], // Bearish targets (dollar weakness)
      notes: 'De-dollarization. $36T debt. Twin deficits.'
    },
  });

  const scenarios = {
    bull: { drift: 0.50, label: 'Bull', volMult: 1.1, color: t.green },
    base: { drift: 0.30, label: 'Base', volMult: 1.0, color: t.accent },
    bear: { drift: 0.10, label: 'Bear', volMult: 0.9, color: t.red }
  };

  const horizons = [83, 174, 358];
  const labels = ['Q1 2026', 'H1 2026', 'FY 2026'];

  // Monte Carlo
  const runSim = useCallback((key, sc, N = 5000) => {
    const { spot, targets, vol } = assets[key];
    const { drift, volMult } = scenarios[sc];
    const v = vol * volMult, dt = 1 / 365, maxD = 358;
    const paths = [], finals = [[], [], []];

    for (let i = 0; i < N; i++) {
      let p = spot;
      const path = [{ d: 0, p }];
      for (let d = 1; d <= maxD; d++) {
        p *= Math.exp((drift - 0.5 * v * v) * dt + v * Math.sqrt(dt) * nRand(simSeed + i * maxD + d));
        if (i < 50) path.push({ d, p });
        horizons.forEach((h, j) => { if (d === h) finals[j].push(p); });
      }
      if (i < 50) paths.push(path);
    }

    const pctData = [];
    for (let d = 0; d <= maxD; d += 5) {
      const ps = paths.map(x => x[Math.floor(d / 5)]?.p || spot).sort((a, b) => a - b);
      pctData.push({ d, p5: ps[Math.floor(ps.length * 0.05)], p50: ps[Math.floor(ps.length * 0.5)], p95: ps[Math.floor(ps.length * 0.95)] });
    }

    const probs = targets.map((tgt, i) => {
      const f = finals[i];
      if (!f.length) return { tgt, mc: 0, bs: 0, mean: spot, p5: spot, p95: spot };
      const sorted = [...f].sort((a, b) => a - b);
      return { tgt, mc: f.filter(x => x >= tgt).length / f.length, bs: bsP(spot, tgt, 0.045, v, horizons[i] / 365), mean: f.reduce((a, b) => a + b, 0) / f.length, p5: sorted[Math.floor(sorted.length * 0.05)], p95: sorted[Math.floor(sorted.length * 0.95)] };
    });

    return { pctData, probs, finals };
  }, [assets, simSeed]);

  const res = useMemo(() => runSim(asset, scenario), [asset, scenario, runSim]);
  const allRes = useMemo(() => Object.fromEntries(Object.keys(scenarios).map(k => [k, runSim(asset, k)])), [asset, runSim]);

  const hist = useMemo(() => {
    const f = res.finals[sel];
    if (!f?.length) return [];
    const min = Math.min(...f), max = Math.max(...f), sz = (max - min) / 20 || 1;
    return Array(20).fill(0).map((_, i) => ({ r: min + i * sz, c: f.filter(x => x >= min + i * sz && x < min + (i + 1) * sz).length }));
  }, [res.finals, sel]);

  const a = assets[asset];
  const fibs = calcFibTargets(a.spot, a.lo52, a.hi52);
  const fmt = p => p >= 10000 ? `${(p/1000).toFixed(1)}K` : p >= 100 ? p.toFixed(0) : p >= 1 ? p.toFixed(2) : p.toFixed(4);
  const pCol = p => p >= 0.15 ? t.green : p >= 0.02 ? t.yellow : t.red;

  // Glass Card
  const Card = ({ children, style, onClick }) => (
    <div onClick={onClick} style={{
      background: t.glass,
      backdropFilter: 'blur(40px) saturate(180%)',
      WebkitBackdropFilter: 'blur(40px) saturate(180%)',
      borderRadius: 20,
      border: `0.5px solid ${t.border}`,
      boxShadow: dark ? '0 8px 32px rgba(0,0,0,0.4)' : '0 8px 32px rgba(0,0,0,0.08)',
      cursor: onClick ? 'pointer' : 'default',
      overflow: 'hidden',
      ...style
    }}>{children}</div>
  );

  return (
    <div style={{ minHeight: '100vh', background: t.bg, color: t.text, fontFamily: '-apple-system, BlinkMacSystemFont, "SF Pro Display", sans-serif', padding: 0 }}>

      {/* Status Bar */}
      <div style={{ padding: '12px 16px', display: 'flex', justifyContent: 'space-between', alignItems: 'center', borderBottom: `0.5px solid ${t.border}` }}>
        <span style={{ fontSize: 13, fontWeight: 600 }}>Monte Carlo Terminal</span>
        <div style={{ display: 'flex', gap: 12, alignItems: 'center' }}>
          <button onClick={() => setShowMacro(!showMacro)} style={{ background: showMacro ? t.accent : 'transparent', border: `1px solid ${t.border}`, borderRadius: 8, padding: '4px 10px', color: showMacro ? '#fff' : t.textSecondary, fontSize: 11, cursor: 'pointer' }}>MACRO</button>
          <button onClick={() => setSimSeed(Date.now())} style={{ background: 'transparent', border: 'none', fontSize: 16, cursor: 'pointer' }}>üé≤</button>
          <button onClick={() => setDark(!dark)} style={{ background: 'transparent', border: 'none', fontSize: 16, cursor: 'pointer' }}>{dark ? '‚òÄÔ∏è' : 'üåô'}</button>
        </div>
      </div>

      {/* Ticker Tape */}
      <div style={{ padding: '8px 16px', display: 'flex', gap: 16, overflowX: 'auto', borderBottom: `0.5px solid ${t.border}`, background: t.surface }}>
        {['silver', 'gold', 'btc', 'nas100', 'us500', 'oil'].map(k => (
          <span key={k} onClick={() => setAsset(k)} style={{ display: 'flex', gap: 6, fontSize: 12, cursor: 'pointer', opacity: asset === k ? 1 : 0.6 }}>
            <span style={{ fontWeight: 600 }}>{assets[k].name}</span>
            <span>{fmt(assets[k].spot)}</span>
            <span style={{ color: assets[k].chgPct >= 0 ? t.green : t.red }}>{assets[k].chgPct >= 0 ? '+' : ''}{assets[k].chgPct.toFixed(2)}%</span>
          </span>
        ))}
      </div>

      {/* Macro Alert Banner */}
      {showMacro && (
        <div style={{ padding: 16, background: `linear-gradient(135deg, ${t.red}20, ${t.orange}20)`, borderBottom: `0.5px solid ${t.border}` }}>
          <div style={{ fontSize: 11, fontWeight: 700, color: t.orange, marginBottom: 8 }}>‚ö†Ô∏è MACRO RISK SYNTHESIS</div>
          <div style={{ fontSize: 12, lineHeight: 1.6, color: t.textSecondary }}>
            <p style={{ margin: '0 0 8px' }}><strong style={{ color: t.red }}>AI Circular Funding:</strong> OpenAI ‚Üî Nvidia ‚Üî CoreWeave. $1T+ in interconnected deals. Nvidia invests in OpenAI, OpenAI buys Nvidia chips. SPV structures reminiscent of 2008.</p>
            <p style={{ margin: '0 0 8px' }}><strong style={{ color: t.yellow }}>US Debt:</strong> $36T national debt. $1.5T AI infrastructure borrowing. Tech capex = 3% of GDP by 2026. OpenAI partners carry $96B debt.</p>
            <p style={{ margin: '0 0 8px' }}><strong style={{ color: t.orange }}>Dollar Risk:</strong> DXY below 100. De-dollarization accelerating. 1971 Nixon shock parallel - fiat untethered from gold.</p>
            <p style={{ margin: 0 }}><strong style={{ color: t.cyan }}>Metals Thesis:</strong> Hard assets hedge against fiat debasement. Silver industrial demand (solar, AI servers). Central banks buying 850t gold/year.</p>
          </div>
        </div>
      )}

      <div style={{ padding: 16 }}>
        {/* Asset Grid */}
        <div style={{ display: 'flex', gap: 8, overflowX: 'auto', marginBottom: 16, paddingBottom: 4 }}>
          {Object.entries(assets).map(([k, v]) => (
            <button key={k} onClick={() => setAsset(k)} style={{
              padding: '10px 14px',
              borderRadius: 12,
              border: asset === k ? `2px solid ${t.accent}` : `1px solid ${t.border}`,
              background: asset === k ? `${t.accent}15` : t.glass,
              backdropFilter: 'blur(20px)',
              color: asset === k ? t.accent : t.textSecondary,
              fontSize: 12,
              fontWeight: 600,
              whiteSpace: 'nowrap',
              cursor: 'pointer',
              minWidth: 80,
              textAlign: 'center'
            }}>
              <div>{v.name}</div>
              <div style={{ fontSize: 10, marginTop: 2, color: v.chgPct >= 0 ? t.green : t.red }}>{v.chgPct >= 0 ? '+' : ''}{v.chgPct.toFixed(1)}%</div>
            </button>
          ))}
        </div>

        {/* Main Quote Card */}
        <Card style={{ padding: 20, marginBottom: 16 }}>
          <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start' }}>
            <div>
              <div style={{ fontSize: 11, color: t.textTertiary, textTransform: 'uppercase', letterSpacing: 1 }}>{a.full}</div>
              <div style={{ fontSize: 36, fontWeight: 700, marginTop: 4 }}>${fmt(a.spot)}</div>
              <div style={{ fontSize: 14, color: a.chgPct >= 0 ? t.green : t.red, marginTop: 4 }}>
                {a.chgPct >= 0 ? '‚ñ≤' : '‚ñº'} {Math.abs(a.chg).toFixed(2)} ({a.chgPct >= 0 ? '+' : ''}{a.chgPct.toFixed(2)}%)
              </div>
            </div>
            <div style={{ textAlign: 'right' }}>
              <div style={{ fontSize: 10, color: t.textTertiary }}>52W RANGE</div>
              <div style={{ fontSize: 13, marginTop: 4 }}>${fmt(a.lo52)} ‚Äî ${fmt(a.hi52)}</div>
              <div style={{ fontSize: 10, color: t.textTertiary, marginTop: 8 }}>VOLATILITY</div>
              <div style={{ fontSize: 13, color: t.yellow }}>{(a.vol * 100).toFixed(0)}%</div>
            </div>
          </div>

          {/* Notes */}
          <div style={{ marginTop: 16, padding: 12, background: t.surface, borderRadius: 12 }}>
            <div style={{ fontSize: 11, color: t.textSecondary }}>{a.notes}</div>
          </div>
        </Card>

        {/* Fibonacci / Institutional Levels */}
        <Card style={{ padding: 16, marginBottom: 16 }}>
          <div style={{ fontSize: 13, fontWeight: 600, marginBottom: 12 }}>Key Levels</div>
          <div style={{ display: 'grid', gridTemplateColumns: 'repeat(2, 1fr)', gap: 8 }}>
            <div>
              <div style={{ fontSize: 10, color: t.green, marginBottom: 6 }}>SUPPORT</div>
              {a.support.map((s, i) => (
                <div key={i} style={{ fontSize: 12, padding: '4px 0', borderBottom: `0.5px solid ${t.border}`, display: 'flex', justifyContent: 'space-between' }}>
                  <span style={{ color: t.textTertiary }}>S{i + 1}</span>
                  <span style={{ color: t.green }}>${fmt(s)}</span>
                </div>
              ))}
            </div>
            <div>
              <div style={{ fontSize: 10, color: t.red, marginBottom: 6 }}>RESISTANCE</div>
              {a.resistance.map((r, i) => (
                <div key={i} style={{ fontSize: 12, padding: '4px 0', borderBottom: `0.5px solid ${t.border}`, display: 'flex', justifyContent: 'space-between' }}>
                  <span style={{ color: t.textTertiary }}>R{i + 1}</span>
                  <span style={{ color: t.red }}>${fmt(r)}</span>
                </div>
              ))}
            </div>
          </div>

          {/* Fib Extensions */}
          <div style={{ marginTop: 12 }}>
            <div style={{ fontSize: 10, color: t.purple, marginBottom: 6 }}>FIBONACCI EXTENSIONS</div>
            <div style={{ display: 'flex', flexWrap: 'wrap', gap: 8 }}>
              {[['61.8%', fibs.fib618], ['78.6%', fibs.fib786], ['100%', fibs.fib100], ['127.2%', fibs.fib1272], ['161.8%', fibs.fib1618]].map(([label, val]) => (
                <div key={label} style={{ padding: '4px 8px', background: t.surface, borderRadius: 6, fontSize: 11 }}>
                  <span style={{ color: t.textTertiary }}>{label}</span> <span style={{ color: t.purple }}>${fmt(val)}</span>
                </div>
              ))}
            </div>
          </div>
        </Card>

        {/* Scenario Selector */}
        <div style={{ display: 'flex', gap: 8, marginBottom: 16 }}>
          {Object.entries(scenarios).map(([k, v]) => (
            <button key={k} onClick={() => setScenario(k)} style={{
              flex: 1, padding: 12, borderRadius: 12,
              border: scenario === k ? `2px solid ${v.color}` : `1px solid ${t.border}`,
              background: scenario === k ? `${v.color}15` : t.glass,
              backdropFilter: 'blur(20px)',
              color: scenario === k ? v.color : t.textSecondary,
              fontSize: 13, fontWeight: 600, cursor: 'pointer'
            }}>
              {v.label}
              <div style={{ fontSize: 10, fontWeight: 400, marginTop: 2 }}>Œº={v.drift * 100}%</div>
            </button>
          ))}
        </div>

        {/* Chart */}
        <Card style={{ padding: 16, marginBottom: 16 }}>
          <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: 12 }}>
            <span style={{ fontSize: 13, fontWeight: 600 }}>Monte Carlo Projection</span>
            <span style={{ fontSize: 11, color: t.textTertiary }}>5K sims</span>
          </div>
          <ResponsiveContainer width="100%" height={200}>
            <ComposedChart data={res.pctData} margin={{ top: 5, right: 5, bottom: 5, left: -15 }}>
              <defs>
                <linearGradient id="band" x1="0" y1="0" x2="0" y2="1">
                  <stop offset="0%" stopColor={t.accent} stopOpacity={0.3} />
                  <stop offset="100%" stopColor={t.accent} stopOpacity={0.02} />
                </linearGradient>
              </defs>
              <XAxis dataKey="d" stroke={t.textTertiary} tick={{ fontSize: 10, fill: t.textTertiary }} tickFormatter={d => d === 0 ? 'Now' : `${Math.round(d/30)}m`} />
              <YAxis stroke={t.textTertiary} tick={{ fontSize: 10, fill: t.textTertiary }} tickFormatter={fmt} domain={['auto', 'auto']} />
              <Tooltip contentStyle={{ background: t.glass, backdropFilter: 'blur(20px)', border: `0.5px solid ${t.border}`, borderRadius: 12, fontSize: 12 }} formatter={v => [`${fmt(v)}`, '']} />
              <Area type="monotone" dataKey="p95" stroke="none" fill="url(#band)" />
              <Area type="monotone" dataKey="p5" stroke="none" fill={t.bg} />
              <Line type="monotone" dataKey="p5" stroke={t.textTertiary} strokeWidth={1} strokeDasharray="3 3" dot={false} />
              <Line type="monotone" dataKey="p50" stroke={t.accent} strokeWidth={2} dot={false} />
              <Line type="monotone" dataKey="p95" stroke={t.textTertiary} strokeWidth={1} strokeDasharray="3 3" dot={false} />
              {a.targets.map((tgt, i) => <ReferenceLine key={tgt} y={tgt} stroke={[t.green, t.yellow, t.red][i]} strokeDasharray="4 4" strokeWidth={1.5} />)}
            </ComposedChart>
          </ResponsiveContainer>
          <div style={{ display: 'flex', justifyContent: 'center', gap: 16, marginTop: 8 }}>
            {a.targets.map((tgt, i) => (
              <span key={i} style={{ fontSize: 11, color: [t.green, t.yellow, t.red][i] }}>‚óè ${fmt(tgt)}</span>
            ))}
          </div>
        </Card>

        {/* Probability Cards */}
        <div style={{ display: 'flex', flexDirection: 'column', gap: 12, marginBottom: 16 }}>
          {res.probs.map((p, i) => (
            <Card key={i} onClick={() => setSel(i)} style={{ padding: 16, border: sel === i ? `2px solid ${t.accent}` : `0.5px solid ${t.border}` }}>
              <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
                <div>
                  <div style={{ fontSize: 11, color: t.textTertiary }}>{labels[i]}</div>
                  <div style={{ fontSize: 20, fontWeight: 700, color: [t.green, t.yellow, t.red][i] }}>${fmt(p.tgt)}</div>
                </div>
                <div style={{ textAlign: 'right' }}>
                  <div style={{ fontSize: 28, fontWeight: 700, color: pCol(p.mc) }}>{(p.mc * 100).toFixed(1)}%</div>
                  <div style={{ fontSize: 10, color: t.textTertiary }}>probability</div>
                </div>
              </div>
              <div style={{ display: 'flex', gap: 12, marginTop: 12, paddingTop: 12, borderTop: `0.5px solid ${t.border}` }}>
                <div style={{ flex: 1 }}>
                  <div style={{ fontSize: 10, color: t.textTertiary }}>Black-Scholes</div>
                  <div style={{ fontSize: 14, fontWeight: 600, color: t.cyan }}>{(p.bs * 100).toFixed(1)}%</div>
                </div>
                <div style={{ flex: 1 }}>
                  <div style={{ fontSize: 10, color: t.textTertiary }}>E[Price]</div>
                  <div style={{ fontSize: 14, fontWeight: 600 }}>${fmt(p.mean)}</div>
                </div>
                <div style={{ flex: 1 }}>
                  <div style={{ fontSize: 10, color: t.textTertiary }}>90% CI</div>
                  <div style={{ fontSize: 14, fontWeight: 600 }}>${fmt(p.p5)}‚Äì${fmt(p.p95)}</div>
                </div>
              </div>
            </Card>
          ))}
        </div>

        {/* Distribution */}
        <Card style={{ padding: 16, marginBottom: 16 }}>
          <div style={{ fontSize: 13, fontWeight: 600, marginBottom: 12 }}>Distribution @ {labels[sel]}</div>
          <ResponsiveContainer width="100%" height={120}>
            <BarChart data={hist} margin={{ top: 5, right: 5, bottom: 5, left: -15 }}>
              <XAxis dataKey="r" stroke={t.textTertiary} tick={{ fontSize: 9, fill: t.textTertiary }} tickFormatter={fmt} interval="preserveStartEnd" />
              <Bar dataKey="c" radius={[4, 4, 0, 0]}>
                {hist.map((e, i) => <Cell key={i} fill={e.r >= a.targets[sel] ? t.green : t.accent} fillOpacity={0.8} />)}
              </Bar>
            </BarChart>
          </ResponsiveContainer>
        </Card>

        {/* Scenario Matrix */}
        <Card style={{ padding: 16, marginBottom: 16 }}>
          <div style={{ fontSize: 13, fontWeight: 600, marginBottom: 12 }}>Scenario Matrix</div>
          <table style={{ width: '100%', fontSize: 12, borderCollapse: 'collapse' }}>
            <thead>
              <tr><th style={{ padding: 8, textAlign: 'left', color: t.textTertiary }}></th>
                {a.targets.map((tgt, i) => <th key={i} style={{ padding: 8, textAlign: 'right', color: [t.green, t.yellow, t.red][i] }}>${fmt(tgt)}</th>)}
              </tr>
            </thead>
            <tbody>
              {Object.entries(allRes).map(([k, r]) => (
                <tr key={k} style={{ borderTop: `0.5px solid ${t.border}` }}>
                  <td style={{ padding: 8, fontWeight: 600, color: scenarios[k].color }}>{scenarios[k].label}</td>
                  {r.probs.map((p, i) => <td key={i} style={{ padding: 8, textAlign: 'right', fontWeight: 600, color: pCol(p.mc) }}>{(p.mc * 100).toFixed(1)}%</td>)}
                </tr>
              ))}
            </tbody>
          </table>
        </Card>

        {/* Footer */}
        <div style={{ textAlign: 'center', padding: '16px 0', fontSize: 10, color: t.textTertiary }}>
          Educational only ‚Ä¢ Not financial advice ‚Ä¢ GBM assumes log-normal returns
        </div>
      </div>
    </div>
  );
}

ReactDOM.createRoot(document.getElementById('root')).render(<LiquidGlassTerminal />);
    </script>
</body>
</html>
